<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ç—á—ë—Ç Wildberries</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Arial', sans-serif;
        }
        .report-container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-top: 20px;
        }
        .report-header {
            color: #6f42c1;
            border-bottom: 2px solid #6f42c1;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .metric-card {
            border-left: 4px solid #6f42c1;
            padding: 10px;
            margin-bottom: 15px;
            background: #f9f9f9;
        }
        .metric-value {
            font-weight: bold;
            color: #6f42c1;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="report-container">
            <h1 class="report-header text-center">üìä –û—Ç—á—ë—Ç Wildberries</h1>
            <div id="report-data"></div>
        </div>
    </div>

    <script>
        // –ü–∞—Ä—Å–∏–º –¥–∞–Ω–Ω—ã–µ –∏–∑ URL
        function getReportFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const reportParam = urlParams.get('report');

            if (reportParam) {
                try {
                    // –î–µ–∫–æ–¥–∏—Ä—É–µ–º –∏ –ø–∞—Ä—Å–∏–º JSON
                    const reportData = JSON.parse(decodeURIComponent(reportParam));
                    displayReport(reportData);
                } catch (e) {
                    document.getElementById('report-data').innerHTML = `
                        <div class="alert alert-danger">
                            –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Ç—á—ë—Ç–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.
                        </div>
                    `;
                    console.error("–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö:", e);
                }
            } else {
                document.getElementById('report-data').innerHTML = `
                    <div class="alert alert-warning">
                        –û—Ç—á—ë—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –±–æ—Ç–∞ –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –µ–≥–æ —Å–Ω–æ–≤–∞.
                    </div>
                `;
            }
        }

        // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ—Ç—á—ë—Ç–∞
        function displayReport(data) {
            const reportDiv = document.getElementById('report-data');
            
            reportDiv.innerHTML = `
                <h3 class="text-center mb-4">üìÖ ${data.date || '–ù–µ —É–∫–∞–∑–∞–Ω–∞ –¥–∞—Ç–∞'}</h3>
                
                <div class="row">
                    <!-- –ó–∞–∫–∞–∑—ã -->
                    <div class="col-md-6">
                        <div class="metric-card">
                            <h5>üõç –ó–∞–∫–∞–∑—ã</h5>
                            <p>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: <span class="metric-value">${data.orders_report?.orders_amount || '0'}</span></p>
                            <p>–°—É–º–º–∞: <span class="metric-value">${data.orders_report?.orders_cost || '0'} ‚ÇΩ</span></p>
                        </div>
                    </div>
                    
                    <!-- –ü—Ä–æ–¥–∞–∂–∏ -->
                    <div class="col-md-6">
                        <div class="metric-card">
                            <h5>üí∏ –ü—Ä–æ–¥–∞–∂–∏</h5>
                            <p>–û–±—â–∞—è —Å—É–º–º–∞: <span class="metric-value">${data.sales_report?.total_finished_price || '0'} ‚ÇΩ</span></p>
                            <p>–í—ã–∫—É–ø—ã: <span class="metric-value">${data.sales_report?.sale_count_s || '0'}</span></p>
                            <p>–í–æ–∑–≤—Ä–∞—Ç—ã: <span class="metric-value">${data.sales_report?.sale_count_r || '0'}</span></p>
                        </div>
                    </div>
                    
                    <!-- –†–µ–∫–ª–∞–º–∞ -->
                    <div class="col-md-6">
                        <div class="metric-card">
                            <h5>üìà –†–µ–∫–ª–∞–º–∞</h5>
                            <p>–ó–∞—Ç—Ä–∞—Ç—ã: <span class="metric-value">${data.promotion_report?.sum || '0'} ‚ÇΩ</span></p>
                            <p>–ü—Ä–æ—Å–º–æ—Ç—Ä—ã: <span class="metric-value">${data.promotion_report?.views || '0'}</span></p>
                        </div>
                    </div>
                    
                    <!-- –í–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂ -->
                    <div class="col-md-6">
                        <div class="metric-card">
                            <h5>üîé –í–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂</h5>
                            <p>–ü–µ—Ä–µ—Ö–æ–¥—ã –≤ –∫–∞—Ä—Ç–æ—á–∫—É: <span class="metric-value">${data.sales_funnel?.total_open_card_count || '0'}</span></p>
                            <p>–î–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É: <span class="metric-value">${data.sales_funnel?.total_add_to_cart_count || '0'}</span></p>
                        </div>
                    </div>
                    
                    <!-- –•—Ä–∞–Ω–µ–Ω–∏–µ -->
                    <div class="col-md-12">
                        <div class="metric-card">
                            <h5>üì¶ –ü–ª–∞—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ</h5>
                            <p>–°—Ç–æ–∏–º–æ—Å—Ç—å: <span class="metric-value">${data.paid_storage_report || '0'} ‚ÇΩ</span></p>
                        </div>
                    </div>
                </div>
            `;
        }

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Ç—á—ë—Ç –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = getReportFromURL;
    </script>

    <!-- Bootstrap JS (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>